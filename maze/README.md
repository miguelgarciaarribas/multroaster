Adapted from https://github.com/boppreh/maze.git